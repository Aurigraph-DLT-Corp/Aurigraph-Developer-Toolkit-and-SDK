<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aurigraph DLT V0 Demo Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 50%, #2d1b69 100%);
            color: #ffffff;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #ff6b6b, #4ecdc4);
            background-size: 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 3s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .header p {
            font-size: 1.2em;
            color: #a0a0a0;
            margin-bottom: 20px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            border-radius: 25px;
            font-weight: bold;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            background: #00ff00;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00d4ff, transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.2);
        }

        .metric-title {
            font-size: 0.9em;
            color: #a0a0a0;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #00d4ff;
        }

        .metric-unit {
            font-size: 0.8em;
            color: #666;
        }

        .controls-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .controls-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            text-align: center;
            color: #00d4ff;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .control-group {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .control-label {
            display: block;
            margin-bottom: 10px;
            color: #a0a0a0;
            font-weight: 500;
        }

        .control-input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #ffffff;
            margin-bottom: 15px;
            font-size: 1em;
        }

        .control-input:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.2);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(45deg, #0099cc, #00d4ff);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 153, 204, 0.3);
        }

        .btn-danger {
            background: linear-gradient(45deg, #ff6b6b, #cc4444);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(45deg, #cc4444, #ff6b6b);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
        }

        .nodes-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nodes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .node-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .node-card.validator {
            border-left: 4px solid #ff6b6b;
        }

        .node-card.basic {
            border-left: 4px solid #4ecdc4;
        }

        .node-card.leader {
            border: 2px solid #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .node-id {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .node-stats {
            font-size: 0.8em;
            color: #a0a0a0;
            line-height: 1.4;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 40px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .chart-placeholder {
            color: #666;
            font-size: 1.2em;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #00d4ff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            color: #ff6b6b;
        }

        .success-message {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            color: #00ff00;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .nodes-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üåê Aurigraph DLT V0</h1>
            <p>High-Volume Transaction Processing Demo</p>
            <div class="status-indicator" id="statusIndicator">
                <div class="status-dot"></div>
                <span id="statusText">Connecting...</span>
            </div>
            <div style="margin-top: 15px; font-size: 0.9em; color: #666;">
                <span id="uptimeDisplay">Uptime: --</span> | 
                <span id="nodeCountDisplay">Nodes: --/--</span> | 
                <span id="leaderDisplay">Leader: --</span>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-title">Total TPS</div>
                <div class="metric-value" id="totalTPS">--</div>
                <div class="metric-unit">transactions/second</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Total Transactions</div>
                <div class="metric-value" id="totalTransactions">--</div>
                <div class="metric-unit">processed</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Success Rate</div>
                <div class="metric-value" id="successRate">--</div>
                <div class="metric-unit">%</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Avg Latency</div>
                <div class="metric-value" id="avgLatency">--</div>
                <div class="metric-unit">milliseconds</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Block Height</div>
                <div class="metric-value" id="blockHeight">--</div>
                <div class="metric-unit">blocks</div>
            </div>
            <div class="metric-card">
                <div class="metric-title">Network Load</div>
                <div class="metric-value" id="networkLoad">--</div>
                <div class="metric-unit">%</div>
            </div>
        </div>

        <!-- Transaction Controls -->
        <div class="controls-section">
            <h2 class="controls-title">üöÄ Transaction Controls</h2>
            <div class="controls-grid">
                <div class="control-group">
                    <label class="control-label">Single Transaction</label>
                    <input type="number" class="control-input" id="singleAmount" placeholder="Amount" value="100">
                    <button class="btn btn-primary" onclick="submitSingleTransaction()">
                        Submit Transaction
                    </button>
                </div>
                <div class="control-group">
                    <label class="control-label">Bulk Transactions</label>
                    <input type="number" class="control-input" id="bulkCount" placeholder="Count" value="1000" min="1" max="10000">
                    <button class="btn btn-primary" onclick="submitBulkTransactions()">
                        Submit Bulk
                    </button>
                </div>
                <div class="control-group">
                    <label class="control-label">Load Test</label>
                    <select class="control-input" id="loadIntensity">
                        <option value="low">Low (1K TPS)</option>
                        <option value="medium">Medium (5K TPS)</option>
                        <option value="high" selected>High (15K TPS)</option>
                        <option value="extreme">Extreme (50K TPS)</option>
                    </select>
                    <button class="btn btn-danger" onclick="triggerLoadTest()">
                        Start Load Test
                    </button>
                </div>
            </div>
            <div id="controlMessages"></div>
        </div>

        <!-- TPS Chart Placeholder -->
        <div class="chart-container">
            <h2 style="margin-bottom: 20px; color: #00d4ff;">üìà Real-Time TPS Chart</h2>
            <div class="chart-placeholder">
                <div class="loading"></div>
                <p style="margin-top: 15px;">TPS visualization coming in future version</p>
            </div>
        </div>

        <!-- Node Status -->
        <div class="nodes-section">
            <h2 style="margin-bottom: 20px; color: #00d4ff;">üñ•Ô∏è Node Network Status</h2>
            <div class="nodes-grid" id="nodesGrid">
                <!-- Nodes will be populated dynamically -->
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>üåü Aurigraph DLT V0 Demo Dashboard - Real-time Blockchain Performance Monitor</p>
            <p>API Endpoint: http://localhost:4000 | Refresh Rate: 2s</p>
        </div>
    </div>

    <script>
        let isConnected = false;
        let updateInterval;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            startDataUpdates();
        });

        // Start periodic data updates
        function startDataUpdates() {
            updateDashboard();
            updateInterval = setInterval(updateDashboard, 2000); // Update every 2 seconds
        }

        // Fetch and update dashboard data
        async function updateDashboard() {
            try {
                const response = await fetch('http://localhost:4000/channel/status');
                if (!response.ok) throw new Error('API not responding');
                
                const data = await response.json();
                updateMetrics(data);
                updateStatus(true, 'ACTIVE');
                
                // Fetch nodes data
                const nodesResponse = await fetch('http://localhost:4000/channel/nodes');
                if (nodesResponse.ok) {
                    const nodesData = await nodesResponse.json();
                    updateNodes(nodesData.nodes);
                }
                
                isConnected = true;
            } catch (error) {
                console.error('Dashboard update error:', error);
                updateStatus(false, 'DISCONNECTED');
                isConnected = false;
            }
        }

        // Update metrics display
        function updateMetrics(data) {
            const metrics = data.metrics;
            
            document.getElementById('totalTPS').textContent = formatNumber(metrics.totalTPS);
            document.getElementById('totalTransactions').textContent = formatNumber(metrics.totalTransactions);
            
            const successRate = metrics.totalTransactions > 0 
                ? ((metrics.confirmedTransactions / metrics.totalTransactions) * 100).toFixed(1)
                : '0.0';
            document.getElementById('successRate').textContent = successRate;
            
            document.getElementById('avgLatency').textContent = metrics.avgLatency.toFixed(1);
            document.getElementById('blockHeight').textContent = formatNumber(metrics.blockHeight);
            document.getElementById('networkLoad').textContent = metrics.networkLoad.toFixed(1);
            
            // Update header info
            document.getElementById('uptimeDisplay').textContent = `Uptime: ${formatUptime(data.uptime)}`;
            document.getElementById('nodeCountDisplay').textContent = `Nodes: ${metrics.activeNodes}/${metrics.totalNodes}`;
            document.getElementById('leaderDisplay').textContent = `Leader: ${data.leader}`;
        }

        // Update connection status
        function updateStatus(connected, statusText) {
            const indicator = document.getElementById('statusIndicator');
            const statusTextEl = document.getElementById('statusText');
            
            if (connected) {
                indicator.style.background = 'rgba(0, 255, 0, 0.1)';
                indicator.style.borderColor = '#00ff00';
                statusTextEl.textContent = statusText;
            } else {
                indicator.style.background = 'rgba(255, 107, 107, 0.1)';
                indicator.style.borderColor = '#ff6b6b';
                statusTextEl.textContent = statusText;
            }
        }

        // Update nodes display
        function updateNodes(nodes) {
            const nodesGrid = document.getElementById('nodesGrid');
            nodesGrid.innerHTML = '';
            
            // Show first 20 nodes to avoid overcrowding
            const displayNodes = nodes.slice(0, 20);
            
            displayNodes.forEach(node => {
                const nodeCard = document.createElement('div');
                nodeCard.className = `node-card ${node.type}${node.isLeader ? ' leader' : ''}`;
                
                nodeCard.innerHTML = `
                    <div class="node-id">
                        ${node.isLeader ? 'üëë ' : ''}${node.id}
                        ${node.type === 'validator' ? ' üõ°Ô∏è' : ' üíª'}
                    </div>
                    <div class="node-stats">
                        TPS: ${formatNumber(node.tps || 0)}<br>
                        Latency: ${(node.latency || 0).toFixed(1)}ms<br>
                        Txns: ${formatNumber(node.transactionCount || 0)}
                    </div>
                `;
                
                nodesGrid.appendChild(nodeCard);
            });
            
            // Add summary card if more than 20 nodes
            if (nodes.length > 20) {
                const summaryCard = document.createElement('div');
                summaryCard.className = 'node-card';
                summaryCard.style.border = '2px dashed rgba(255,255,255,0.3)';
                summaryCard.innerHTML = `
                    <div class="node-id">+ ${nodes.length - 20} More</div>
                    <div class="node-stats">
                        Total: ${nodes.length} nodes<br>
                        Validators: ${nodes.filter(n => n.type === 'validator').length}<br>
                        Basic: ${nodes.filter(n => n.type === 'basic').length}
                    </div>
                `;
                nodesGrid.appendChild(summaryCard);
            }
        }

        // Submit single transaction
        async function submitSingleTransaction() {
            const amount = document.getElementById('singleAmount').value;
            showMessage('Submitting single transaction...', 'info');
            
            try {
                const response = await fetch('http://localhost:4000/channel/transaction', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: parseInt(amount) })
                });
                
                const result = await response.json();
                showMessage(`Transaction submitted! ID: ${result.txId}`, 'success');
            } catch (error) {
                showMessage('Failed to submit transaction: ' + error.message, 'error');
            }
        }

        // Submit bulk transactions
        async function submitBulkTransactions() {
            const count = document.getElementById('bulkCount').value;
            showMessage(`Submitting ${count} bulk transactions...`, 'info');
            
            try {
                const response = await fetch('http://localhost:4000/channel/transactions/bulk', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ count: parseInt(count) })
                });
                
                const result = await response.json();
                showMessage(`${result.count} transactions submitted successfully!`, 'success');
            } catch (error) {
                showMessage('Failed to submit bulk transactions: ' + error.message, 'error');
            }
        }

        // Trigger load test
        async function triggerLoadTest() {
            const intensity = document.getElementById('loadIntensity').value;
            showMessage(`Starting ${intensity} intensity load test...`, 'info');
            
            try {
                const response = await fetch('http://localhost:4000/channel/loadtest', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ intensity })
                });
                
                const result = await response.json();
                showMessage(`Load test started: ${result.intensity} intensity`, 'success');
            } catch (error) {
                showMessage('Failed to start load test: ' + error.message, 'error');
            }
        }

        // Show status message
        function showMessage(message, type) {
            const messagesDiv = document.getElementById('controlMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'error' ? 'error-message' : 
                                  type === 'success' ? 'success-message' : 
                                  'success-message';
            messageDiv.textContent = message;
            
            messagesDiv.appendChild(messageDiv);
            
            // Remove message after 5 seconds
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.parentNode.removeChild(messageDiv);
                }
            }, 5000);
        }

        // Format numbers with commas
        function formatNumber(num) {
            return num.toLocaleString();
        }

        // Format uptime
        function formatUptime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            if (hours > 0) {
                return `${hours}h ${minutes}m ${secs}s`;
            } else if (minutes > 0) {
                return `${minutes}m ${secs}s`;
            } else {
                return `${secs}s`;
            }
        }

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (updateInterval) {
                clearInterval(updateInterval);
            }
        });
    </script>
</body>
</html>