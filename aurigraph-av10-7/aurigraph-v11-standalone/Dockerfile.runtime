FROM eclipse-temurin:21-jre-jammy

WORKDIR /app

# Copy pre-built JAR
COPY target/aurigraph-v11-standalone-11.4.4-runner.jar /app/app.jar

# Create health check script
RUN apt-get update && apt-get install -y curl && rm -rf /var/lib/apt/lists/*

HEALTHCHECK --interval=10s --timeout=5s --retries=3 \
    CMD curl -f http://localhost:9003/q/health || exit 1

ENV JAVA_OPTS="-Xmx512m -Xms256m"
EXPOSE 9003 9004

ENTRYPOINT ["java"]
CMD ["-jar", "/app/app.jar"]
