# Aurigraph V11 Native Image Configuration for Production
# Optimized for <1 second startup and <128MB memory footprint

# Build Args for Maximum Performance
Args = --initialize-at-build-time=org.slf4j.LoggerFactory,org.slf4j.impl.StaticLoggerBinder \
       --initialize-at-run-time=io.netty.channel.unix.Socket,io.netty.channel.unix.Errors,io.netty.channel.unix.FileDescriptor,io.netty.channel.unix.IovArray \
       --initialize-at-run-time=io.grpc.netty.shaded.io.netty.channel.unix.Socket \
       --initialize-at-run-time=io.aurigraph.v11.consensus.HyperRAFTConsensusService \
       --initialize-at-run-time=io.aurigraph.v11.ai.AIOptimizationService \
       --initialize-at-run-time=io.aurigraph.bridge.CrossChainBridgeService \
       --enable-https \
       --enable-http \
       --enable-url-protocols=http,https,grpc \
       --allow-incomplete-classpath \
       --report-unsupported-elements-at-runtime \
       --no-fallback \
       --install-exit-handlers \
       --enable-monitoring=heapdump,jfr,jvmstat \
       -H:+UnlockExperimentalVMOptions \
       -H:+UseContainerSupport \
       -H:+UseCompressedOOPS \
       -H:+UseSerialGC \
       -H:InitialCollectionPolicy=com.oracle.svm.core.genscavenge.CollectOnAllocation \
       -H:MaxHeapSize=256m \
       -H:MinHeapSize=64m \
       -H:NewRatio=1 \
       -H:+UnlockExperimentalVMOptions \
       -H:+UsePerfData \
       -H:+JmxEnabled \
       -H:+EnableJNI \
       -H:+StaticExecutable \
       -H:ReflectionConfigurationFiles=META-INF/native-image/reflect-config.json \
       -H:ResourceConfigurationFiles=META-INF/native-image/resource-config.json \
       -H:DynamicProxyConfigurationFiles=META-INF/native-image/proxy-config.json \
       -H:SerializationConfigurationFiles=META-INF/native-image/serialization-config.json \
       -H:IncludeResources=.*\\.proto$,.*\\.json$,.*\\.properties$,.*\\.yml$,.*\\.yaml$ \
       -H:Log=registerResource:5 \
       -H:EnableVMAssertions=false \
       -H:+RemoveUnusedSymbols \
       -H:+ReportExceptionStackTraces \
       -H:+ReportUnsupportedElementsAtRuntime \
       -H:+PrintAnalysisCallTree \
       -H:+TraceClassInitialization \
       -H:+TraceObjectInstantiation \
       -H:DeadlockWatchdogInterval=60 \
       -H:DeadlockWatchdogExitOnTimeout=true