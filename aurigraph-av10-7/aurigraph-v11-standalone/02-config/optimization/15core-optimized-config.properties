# Aurigraph V11 - Optimized Configuration for 15-Core Xeon Gold + 64GB RAM
# Expected Performance: 1.2M - 1.6M TPS

# ========================================
# Core Application Settings - 15-Core Optimized
# ========================================

quarkus.application.name=aurigraph-v11-15core
quarkus.application.version=12.0.0-15core-optimized

# HTTP Configuration - Optimized for 15 cores
quarkus.http.port=9003
quarkus.http.host=0.0.0.0
quarkus.http.so-reuse-port=true
quarkus.http.tcp-quick-ack=true

# HTTP/2 Performance - Scaled for 15 cores
quarkus.http.http2=true
quarkus.http.limits.max-concurrent-streams=25000
quarkus.http.limits.max-frame-size=8388608
quarkus.http.limits.initial-window-size=524288
quarkus.http.limits.max-header-size=16384

# gRPC Configuration - 15-Core Optimized
quarkus.grpc.server.port=9004
quarkus.grpc.server.host=0.0.0.0
quarkus.grpc.server.use-separate-server=true
quarkus.grpc.server.max-inbound-message-size=8388608

# Virtual Threads - Optimized for 15 cores
quarkus.virtual-threads.enabled=true
quarkus.virtual-threads.name-pattern=xeon15-vt-#

# ========================================
# Performance Tuning - 15-Core Xeon Gold
# ========================================

# Consensus Configuration - 15-Core Optimized
consensus.node.id=aurigraph-v11-xeon15-node-1
consensus.election.timeout.ms=750
consensus.heartbeat.interval.ms=75
consensus.batch.size=75000
consensus.pipeline.depth=30
consensus.parallel.threads=30
consensus.target.tps=1600000

# Production consensus settings - 15-core optimized
%prod.consensus.batch.size=100000
%prod.consensus.pipeline.depth=45
%prod.consensus.parallel.threads=45
%prod.consensus.target.tps=1800000
%prod.consensus.election.timeout.ms=500
%prod.consensus.heartbeat.interval.ms=50

# ========================================
# AI Optimization - 15-Core Configuration
# ========================================

# AI Target Performance - Realistic for 15 cores
ai.consensus.target.tps=1600000
ai.optimization.enabled=true
ai.optimization.learning.rate=0.0001
ai.optimization.model.update.interval.ms=5000
ai.optimization.target.tps=1600000

# Neural Network - 15-Core Optimized
ai.ml.neural.network.enabled=true
ai.ml.learning.rate=0.0001
ai.ml.epochs=750
ai.ml.batch.size=512
ai.ml.hidden.layers=1024,512,256,128

# Adaptive Batch Processing - 15-Core Optimized
ai.batch.adaptive.enabled=true
ai.batch.min.size=10000
ai.batch.max.size=150000
ai.batch.target.size=75000
ai.batch.size.adjustment.factor=0.25
ai.batch.timeout.ms=30

# ========================================
# Resource Management - 64GB RAM + 15 Cores
# ========================================

# Thread Pool Configuration - 15-Core Optimized
ai.resources.thread.pool.size=128
ai.resources.memory.limit.mb=32768  # 32GB for AI (50% of 64GB)
ai.resources.cpu.cores.max=15
ai.resources.disk.cache.size.mb=2048

# Executor Configuration - 15-Core Distribution
ai.executor.ai.processing.threads=20
ai.executor.training.threads=10
ai.executor.optimization.threads=8
ai.executor.monitoring.threads=4
ai.executor.virtual.threads.enabled=true

# Performance Thresholds - Realistic for 15 cores
ai.perf.tuning.tps.threshold=1600000
ai.perf.tuning.latency.threshold=75
ai.perf.tuning.cpu.threshold=0.75
ai.perf.tuning.memory.threshold=0.7

# ========================================
# Memory Management - 64GB Optimized
# ========================================

# JVM Heap Configuration (will be set via command line)
# Recommended: -Xms32g -Xmx32g (50% of 64GB RAM)

# NUMA Configuration - Single socket assumed
quarkus.native.additional-build-args=--gc=G1

# ========================================
# Network Optimization - 15-Core Tuned
# ========================================

# gRPC Performance - 15-Core Scaling
grpc.max-concurrent-streams=25000
grpc.initial-window-size=524288
grpc.max-frame-size=8388608
grpc.event-loop-threads=15  # Match core count
grpc.use-epoll=true

# Connection Pool - 15-Core Optimized
grpc.pool.max-connections=500
grpc.pool.min-connections=25
grpc.pool.connection-timeout=30

# ========================================
# Logging and Monitoring - Performance Focused
# ========================================

# Reduced logging for performance
quarkus.log.level=WARN
quarkus.log.console.enable=true
quarkus.log.category."io.aurigraph.v11.performance".level=INFO

# Metrics - Essential only
quarkus.micrometer.enabled=true
quarkus.micrometer.export.prometheus.enabled=true

# ========================================
# Development Profile - 15-Core Testing
# ========================================

%dev.quarkus.log.level=INFO
%dev.consensus.batch.size=50000
%dev.consensus.parallel.threads=20
%dev.consensus.target.tps=1200000

# ========================================
# CORS Configuration - Optimized
# ========================================

quarkus.http.cors=true
quarkus.http.cors.origins=https://dlt.aurigraph.io,http://dlt.aurigraph.io,http://localhost:*
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=Content-Type,Authorization,X-Requested-With
quarkus.http.cors.access-control-max-age=86400

# ========================================
# Expected Performance Targets - 15-Core Xeon Gold
# ========================================

# Conservative Estimate: 1.2M TPS
# Optimistic Estimate: 1.6M TPS 
# Peak Performance: 1.8M TPS (with optimizations)

# Resource Utilization Targets:
# - CPU: 70-85% (balanced load across 15 cores)
# - Memory: 50-60% (32GB active, 32GB cache/system)
# - Network: Up to 10 Gbps
# - Storage: 25K+ IOPS for optimal performance

# Performance Scaling Formula:
# TPS ≈ Cores × 100K × Optimization_Factor
# 15 cores × 100K × 1.1 (optimization) = 1.65M TPS theoretical maximum