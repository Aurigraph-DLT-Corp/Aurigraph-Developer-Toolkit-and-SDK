# Alertmanager Configuration for Aurigraph V11 Production\n# Advanced routing, inhibition, and notification management\n\nglobal:\n  # SMTP configuration for email alerts\n  smtp_smarthost: '${SMTP_HOST:-localhost:587}'\n  smtp_from: 'alerts@aurigraph.io'\n  smtp_auth_username: '${SMTP_USERNAME}'\n  smtp_auth_password: '${SMTP_PASSWORD}'\n  smtp_require_tls: true\n  \n  # Global template paths\n  templates:\n    - '/etc/alertmanager/templates/*.tmpl'\n  \n  # Resolve timeout\n  resolve_timeout: 5m\n  \n  # External URL for Alertmanager\n  external_url: 'https://alerts.aurigraph.io'\n\n# Routing tree for alerts\nroute:\n  # Root route configuration\n  group_by: ['alertname', 'cluster', 'service']\n  group_wait: 30s\n  group_interval: 5m\n  repeat_interval: 4h\n  receiver: 'default-receiver'\n  \n  # Child routes for specific alert types\n  routes:\n  \n  # Critical production alerts - immediate escalation\n  - match:\n      severity: critical\n    group_by: ['alertname', 'pod']\n    group_wait: 10s\n    group_interval: 2m\n    repeat_interval: 30m\n    receiver: 'critical-alerts'\n    routes:\n    # SLA violations require immediate attention\n    - match:\n        alert_type: sla_violation\n      group_wait: 5s\n      group_interval: 1m\n      repeat_interval: 15m\n      receiver: 'sla-violation-alerts'\n    \n    # Security incidents\n    - match:\n        alert_type: security\n      group_wait: 5s\n      group_interval: 1m\n      repeat_interval: 10m\n      receiver: 'security-incident-alerts'\n    \n    # Consensus failures\n    - match:\n        component: consensus\n      group_wait: 5s\n      group_interval: 1m\n      repeat_interval: 20m\n      receiver: 'consensus-emergency-alerts'\n  \n  # Warning level alerts\n  - match:\n      severity: warning\n    group_by: ['alertname', 'service']\n    group_wait: 2m\n    group_interval: 10m\n    repeat_interval: 2h\n    receiver: 'warning-alerts'\n    routes:\n    # Performance warnings\n    - match:\n        component: performance\n      receiver: 'performance-alerts'\n    \n    # Infrastructure warnings\n    - match:\n        component: infrastructure\n      receiver: 'infrastructure-alerts'\n    \n    # AI/ML component warnings\n    - match:\n        component: ai-optimization\n      receiver: 'ai-alerts'\n    \n    # Quantum crypto warnings\n    - match:\n        component: quantum-crypto\n      receiver: 'quantum-crypto-alerts'\n  \n  # Capacity planning alerts\n  - match:\n      alert_type: capacity_planning\n    group_by: ['alertname']\n    group_wait: 5m\n    group_interval: 30m\n    repeat_interval: 8h\n    receiver: 'capacity-planning-alerts'\n  \n  # Test alerts (for testing notification channels)\n  - match:\n      alertname: 'TestAlert'\n    receiver: 'test-alerts'\n  \n  # Watchdog alerts (keep-alive)\n  - match:\n      alertname: 'Watchdog'\n    receiver: 'watchdog'\n\n# Alert inhibition rules\ninhibit_rules:\n  # Inhibit low-level alerts when high-level alerts are firing\n  - source_match:\n      severity: 'critical'\n    target_match:\n      severity: 'warning'\n    equal: ['alertname', 'pod']\n  \n  # Inhibit infrastructure alerts when pod is down\n  - source_match:\n      alertname: 'AurigraphPodCrashLooping'\n    target_match_re:\n      alertname: 'Aurigraph.*'\n    equal: ['pod']\n  \n  # Inhibit performance alerts during consensus failures\n  - source_match:\n      component: 'consensus'\n      severity: 'critical'\n    target_match:\n      component: 'performance'\n    equal: ['service']\n  \n  # Inhibit individual node alerts when cluster is down\n  - source_match:\n      alertname: 'AurigraphConsensusNodePartition'\n    target_match_re:\n      alertname: 'AurigraphConsensus.*'\n    equal: ['cluster']\n\n# Notification receivers\nreceivers:\n\n# Default receiver (fallback)\n- name: 'default-receiver'\n  email_configs:\n  - to: '${DEFAULT_EMAIL:-ops@aurigraph.io}'\n    subject: '[Aurigraph V11] {{ .GroupLabels.alertname }} - {{ .GroupLabels.severity }}'\n    body: |\n      {{ range .Alerts }}\n      Alert: {{ .Annotations.summary }}\n      Description: {{ .Annotations.description }}\n      Severity: {{ .Labels.severity }}\n      Service: {{ .Labels.service }}\n      Pod: {{ .Labels.pod | default \"N/A\" }}\n      Runbook: {{ .Annotations.runbook_url | default \"N/A\" }}\n      Dashboard: {{ .Annotations.dashboard_url | default \"N/A\" }}\n      {{ end }}\n    headers:\n      Subject: '[Aurigraph V11] {{ .GroupLabels.alertname }}'\n\n# Critical alerts - multiple channels\n- name: 'critical-alerts'\n  # Slack notification\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-critical'\n    username: 'Aurigraph Alerts'\n    icon_emoji: ':rotating_light:'\n    title: '[CRITICAL] Aurigraph V11 Production Alert'\n    text: |\n      {{ range .Alerts }}\n      *{{ .Annotations.summary }}*\n      \n      *Service:* {{ .Labels.service }}\n      *Pod:* {{ .Labels.pod | default \"N/A\" }}\n      *Severity:* {{ .Labels.severity }}\n      \n      *Description:*\n      {{ .Annotations.description }}\n      \n      {{ if .Annotations.runbook_url }}\n      *Runbook:* {{ .Annotations.runbook_url }}\n      {{ end }}\n      \n      {{ if .Annotations.dashboard_url }}\n      *Dashboard:* {{ .Annotations.dashboard_url }}\n      {{ end }}\n      {{ end }}\n    actions:\n    - type: button\n      text: 'View Dashboard'\n      url: 'https://grafana.aurigraph.io/d/aurigraph-production'\n    - type: button\n      text: 'View Runbooks'\n      url: 'https://docs.aurigraph.io/runbooks'\n    - type: button\n      text: 'Silence Alert'\n      url: 'https://alerts.aurigraph.io/#/silences/new'\n  \n  # PagerDuty for critical alerts\n  pagerduty_configs:\n  - routing_key: '${PAGERDUTY_INTEGRATION_KEY}'\n    description: 'Aurigraph V11 Critical Alert: {{ .GroupLabels.alertname }}'\n    severity: 'critical'\n    details:\n      summary: '{{ range .Alerts }}{{ .Annotations.summary }}{{ end }}'\n      service: '{{ .GroupLabels.service }}'\n      component: '{{ .GroupLabels.component }}'\n      pod: '{{ .GroupLabels.pod }}'\n      runbook_url: '{{ range .Alerts }}{{ .Annotations.runbook_url }}{{ end }}'\n      dashboard_url: 'https://grafana.aurigraph.io/d/aurigraph-production'\n  \n  # Email for critical alerts\n  email_configs:\n  - to: '${CRITICAL_EMAIL:-critical@aurigraph.io}'\n    subject: '[CRITICAL] Aurigraph V11 Production Alert: {{ .GroupLabels.alertname }}'\n    body: |\n      CRITICAL ALERT - IMMEDIATE ATTENTION REQUIRED\n      \n      {{ range .Alerts }}\n      Alert: {{ .Annotations.summary }}\n      Service: {{ .Labels.service }}\n      Pod: {{ .Labels.pod | default \"N/A\" }}\n      Component: {{ .Labels.component | default \"N/A\" }}\n      Priority: {{ .Labels.priority | default \"N/A\" }}\n      \n      Description:\n      {{ .Annotations.description }}\n      \n      {{ if .Annotations.runbook_url }}\n      Runbook: {{ .Annotations.runbook_url }}\n      {{ end }}\n      \n      {{ if .Annotations.dashboard_url }}\n      Dashboard: {{ .Annotations.dashboard_url }}\n      {{ end }}\n      \n      Alert Time: {{ .StartsAt.Format \"2006-01-02 15:04:05 UTC\" }}\n      {{ end }}\n      \n      Direct Links:\n      - Grafana Dashboard: https://grafana.aurigraph.io/d/aurigraph-production\n      - Alertmanager: https://alerts.aurigraph.io\n      - Prometheus: https://prometheus.aurigraph.io\n    headers:\n      Priority: 'high'\n\n# SLA violation alerts\n- name: 'sla-violation-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-sla'\n    username: 'Aurigraph SLA Monitor'\n    icon_emoji: ':exclamation:'\n    title: '[SLA VIOLATION] Aurigraph V11 Production'\n    text: |\n      :exclamation: *SLA VIOLATION DETECTED* :exclamation:\n      \n      {{ range .Alerts }}\n      *{{ .Annotations.summary }}*\n      \n      {{ .Annotations.description }}\n      \n      *Service:* {{ .Labels.service }}\n      *Component:* {{ .Labels.component }}\n      *Alert Time:* {{ .StartsAt.Format \"15:04:05 UTC\" }}\n      {{ end }}\n    color: 'danger'\n  \n  email_configs:\n  - to: '${SLA_EMAIL:-sla@aurigraph.io},${MANAGEMENT_EMAIL:-management@aurigraph.io}'\n    subject: '[SLA VIOLATION] Aurigraph V11 - {{ .GroupLabels.alertname }}'\n    body: |\n      SLA VIOLATION - ESCALATION REQUIRED\n      \n      This alert indicates a violation of our Service Level Agreement.\n      Immediate investigation and remediation is required.\n      \n      {{ range .Alerts }}\n      Alert: {{ .Annotations.summary }}\n      Description: {{ .Annotations.description }}\n      Service: {{ .Labels.service }}\n      Component: {{ .Labels.component }}\n      Started: {{ .StartsAt.Format \"2006-01-02 15:04:05 UTC\" }}\n      \n      {{ if .Annotations.escalation_policy }}\n      Escalation Policy: {{ .Annotations.escalation_policy }}\n      {{ end }}\n      {{ end }}\n\n# Security incident alerts\n- name: 'security-incident-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-security'\n    username: 'Aurigraph Security'\n    icon_emoji: ':shield:'\n    title: '[SECURITY] Aurigraph V11 Security Alert'\n    text: |\n      :shield: *SECURITY ALERT* :shield:\n      \n      {{ range .Alerts }}\n      *{{ .Annotations.summary }}*\n      \n      {{ .Annotations.description }}\n      \n      *Service:* {{ .Labels.service }}\n      *Component:* {{ .Labels.component }}\n      {{ end }}\n    color: 'danger'\n  \n  email_configs:\n  - to: '${SECURITY_EMAIL:-security@aurigraph.io}'\n    subject: '[SECURITY INCIDENT] Aurigraph V11 - {{ .GroupLabels.alertname }}'\n    body: |\n      SECURITY INCIDENT DETECTED\n      \n      {{ range .Alerts }}\n      Alert: {{ .Annotations.summary }}\n      Description: {{ .Annotations.description }}\n      Service: {{ .Labels.service }}\n      Component: {{ .Labels.component }}\n      Time: {{ .StartsAt.Format \"2006-01-02 15:04:05 UTC\" }}\n      {{ end }}\n      \n      Please investigate immediately and follow the security incident response procedure.\n\n# Consensus emergency alerts\n- name: 'consensus-emergency-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-consensus'\n    username: 'Aurigraph Consensus'\n    icon_emoji: ':warning:'\n    title: '[CONSENSUS EMERGENCY] Aurigraph V11'\n    text: |\n      :warning: *CONSENSUS EMERGENCY* :warning:\n      \n      {{ range .Alerts }}\n      *{{ .Annotations.summary }}*\n      \n      {{ .Annotations.description }}\n      \n      *Service:* {{ .Labels.service }}\n      *Pod:* {{ .Labels.pod }}\n      {{ end }}\n    color: 'danger'\n  \n  email_configs:\n  - to: '${CONSENSUS_EMAIL:-consensus@aurigraph.io}'\n    subject: '[CONSENSUS EMERGENCY] Aurigraph V11 - {{ .GroupLabels.alertname }}'\n\n# Warning level alerts\n- name: 'warning-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-alerts'\n    username: 'Aurigraph Monitor'\n    icon_emoji: ':warning:'\n    title: '[WARNING] Aurigraph V11 Production'\n    text: |\n      {{ range .Alerts }}\n      *{{ .Annotations.summary }}*\n      \n      {{ .Annotations.description }}\n      \n      *Service:* {{ .Labels.service }}\n      *Component:* {{ .Labels.component | default \"N/A\" }}\n      *Pod:* {{ .Labels.pod | default \"N/A\" }}\n      {{ end }}\n    color: 'warning'\n\n# Performance alerts\n- name: 'performance-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-performance'\n    username: 'Aurigraph Performance'\n    icon_emoji: ':chart_with_upwards_trend:'\n    title: '[PERFORMANCE] Aurigraph V11 Alert'\n  \n  email_configs:\n  - to: '${PERFORMANCE_EMAIL:-performance@aurigraph.io}'\n    subject: '[PERFORMANCE] Aurigraph V11 - {{ .GroupLabels.alertname }}'\n\n# Infrastructure alerts\n- name: 'infrastructure-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-infrastructure'\n    username: 'Aurigraph Infrastructure'\n    icon_emoji: ':gear:'\n    title: '[INFRASTRUCTURE] Aurigraph V11 Alert'\n\n# AI optimization alerts\n- name: 'ai-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-ai'\n    username: 'Aurigraph AI'\n    icon_emoji: ':robot_face:'\n    title: '[AI/ML] Aurigraph V11 Alert'\n\n# Quantum cryptography alerts\n- name: 'quantum-crypto-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-crypto'\n    username: 'Aurigraph Quantum Crypto'\n    icon_emoji: ':lock:'\n    title: '[QUANTUM CRYPTO] Aurigraph V11 Alert'\n\n# Capacity planning alerts\n- name: 'capacity-planning-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-capacity'\n    username: 'Aurigraph Capacity Planning'\n    icon_emoji: ':chart_with_upwards_trend:'\n    title: '[CAPACITY] Aurigraph V11 Planning Alert'\n  \n  email_configs:\n  - to: '${CAPACITY_EMAIL:-capacity@aurigraph.io}'\n    subject: '[CAPACITY PLANNING] Aurigraph V11 - {{ .GroupLabels.alertname }}'\n\n# Test alerts\n- name: 'test-alerts'\n  slack_configs:\n  - api_url: '${SLACK_WEBHOOK_URL}'\n    channel: '#aurigraph-test'\n    username: 'Aurigraph Test'\n    icon_emoji: ':test_tube:'\n    title: '[TEST] Aurigraph V11 Test Alert'\n    text: 'This is a test alert to verify notification channels are working.'\n\n# Watchdog (keep-alive)\n- name: 'watchdog'\n  # Minimal configuration - just to acknowledge receipt\n  webhook_configs:\n  - url: 'http://localhost:9093/api/v1/alerts'\n    send_resolved: false\n\n# Global notification templates\ntemplates:\n- '/etc/alertmanager/templates/default.tmpl'\n- '/etc/alertmanager/templates/slack.tmpl'\n- '/etc/alertmanager/templates/email.tmpl'\n\n# Time intervals for different notification types\ntime_intervals:\n- name: business-hours\n  time_intervals:\n  - times:\n    - start_time: '09:00'\n      end_time: '17:00'\n    weekdays: ['monday:friday']\n  - times:\n    - start_time: '10:00'\n      end_time: '16:00'\n    weekdays: ['saturday', 'sunday']\n    months: ['january:december']\n\n- name: off-hours\n  time_intervals:\n  - times:\n    - start_time: '17:01'\n      end_time: '08:59'\n    weekdays: ['monday:friday']\n  - times:\n    - start_time: '00:00'\n      end_time: '23:59'\n    weekdays: ['saturday', 'sunday']\n\n# Mute time intervals for maintenance windows\nmute_time_intervals:\n- name: maintenance-window\n  time_intervals:\n  - times:\n    - start_time: '02:00'\n      end_time: '04:00'\n    weekdays: ['sunday']\n    months: ['january:december']\n"