# AV10-17 Compliance Configuration
# Java 24 + Quarkus 3.26.1 + GraalVM Settings

quarkus:
  application:
    name: aurigraph-basicnode
    version: 10.19.0

  # AV10-17 Performance Requirements
  http:
    port: 8080
    host: 0.0.0.0
    limits:
      max-body-size: 10M
      max-header-size: 8K
    read-timeout: PT30S
    keep-alive-timeout: PT30S

  # GraalVM Native Configuration
  native:
    enabled: true
    container-build: true
    builder-image: "quay.io/quarkus/ubi-quarkus-graalvm:24-java24"
    additional-build-args:
      - "--verbose"
      - "--no-fallback"
      - "-H:+ReportExceptionStackTraces"
      - "-H:+PrintGCDetails"
      - "-H:InitialCollectionPolicy=com.oracle.svm.core.genscavenge.CollectionPolicy$BySpaceAndTime"

  # AV10-17 Memory Constraints (<512MB)
  container-image:
    name: "aurigraph/basicnode"
    tag: "10.19.0-av10-17"
    build: true
    push: false
    registry: "docker.io"
    username: "aurigraph"
    builder: docker
    docker:
      dockerfile-jvm-path: src/main/docker/Dockerfile.jvm
      dockerfile-native-path: src/main/docker/Dockerfile.native

  # Health Monitoring (AV10-17 99.99% uptime requirement)
  smallrye-health:
    root-path: /health
    extensions:
      enabled: true
    ui:
      enable: true
      root-path: /health-ui

  # Metrics for AV10-17 Performance Monitoring
  micrometer:
    enabled: true
    export:
      prometheus:
        enabled: true
        path: /metrics

  # WebSocket for Real-time Updates
  websocket:
    max-frame-size: 1048576

  # Caching for Performance
  cache:
    caffeine:
      "node-cache":
        initial-capacity: 100
        maximum-size: 1000
        expire-after-write: PT300S

  # REST Client for AV10-18 Platform Integration
  rest-client:
    "av10-platform":
      url: "http://localhost:3018"
      connect-timeout: 5000
      read-timeout: 10000

  # OpenAPI Documentation
  swagger-ui:
    always-include: true
    path: /api-docs

# AV10-17 Node Configuration
aurigraph:
  node:
    id: "${NODE_ID:basic-node-${random.uuid}}"
    type: "BASIC"
    version: "10.19.0"
    
    # AV10-17 Performance Targets
    performance:
      target-tps: 50000
      max-memory-mb: 512
      startup-timeout-seconds: 5
      uptime-target-percent: 99.99
    
    # Channel Configuration
    channels:
      enabled: true
      auto-join: true
      types:
        - "CONSENSUS"
        - "PROCESSING" 
        - "GEOGRAPHIC"
      
    # AV10-18 Platform Integration
    platform:
      endpoint: "http://localhost:3018"
      api-version: "v10"
      quantum-security: true
      consensus-participation: true
      
    # Security Configuration (AV10-17 Quantum Level 6)
    security:
      quantum-level: 6
      encryption: "POST_QUANTUM"
      key-rotation-hours: 24
      audit-logs: true

# Logging Configuration
quarkus:
  log:
    level: INFO
    category:
      "io.aurigraph": DEBUG
    console:
      enable: true
      format: "%d{yyyy-MM-dd HH:mm:ss} %-5p [%c{2.}] %s%e%n"
    file:
      enable: true
      path: "/tmp/aurigraph-basicnode.log"
      format: "%d{yyyy-MM-dd HH:mm:ss} %-5p [%c{2.}] %s%e%n"

# Development Profile
"%dev":
  quarkus:
    http:
      port: 8080
    log:
      level: DEBUG

# Production Profile  
"%prod":
  quarkus:
    http:
      port: 8080
    log:
      level: INFO
      file:
        enable: true
        path: "/var/log/aurigraph/basicnode.log"
        
# Native Profile for GraalVM
"%native":
  quarkus:
    native:
      enabled: true
      container-build: true