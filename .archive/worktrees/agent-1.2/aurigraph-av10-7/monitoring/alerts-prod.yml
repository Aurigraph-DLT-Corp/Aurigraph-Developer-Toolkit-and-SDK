groups:
  - name: aurigraph-av10-platform-alerts
    rules:
      # Critical Performance Alerts
      - alert: CriticalThroughputDrop
        expr: rate(aurigraph_tps_total[5m]) < 500000
        for: 2m
        labels:
          severity: critical
          component: performance
        annotations:
          summary: "Critical TPS drop detected"
          description: "TPS has dropped below 500K for more than 2 minutes. Current: {{ $value }}"

      - alert: TargetThroughputNotMet
        expr: rate(aurigraph_tps_total[5m]) < 800000
        for: 5m
        labels:
          severity: warning
          component: performance
        annotations:
          summary: "Performance below target"
          description: "TPS below 800K target for 5+ minutes. Current: {{ $value }}"

      - alert: HighLatency
        expr: histogram_quantile(0.95, rate(aurigraph_transaction_latency_seconds_bucket[5m])) > 1.0
        for: 3m
        labels:
          severity: warning
          component: performance
        annotations:
          summary: "High transaction latency detected"
          description: "95th percentile latency is {{ $value }}s, above 1s threshold"

  - name: aurigraph-consensus-alerts
    rules:
      # Consensus Health Alerts
      - alert: ValidatorNodeDown
        expr: up{job="aurigraph-validators"} == 0
        for: 1m
        labels:
          severity: critical
          component: consensus
        annotations:
          summary: "Validator node is down"
          description: "Validator {{ $labels.instance }} has been down for more than 1 minute"

      - alert: ConsensusFailure
        expr: increase(aurigraph_consensus_failures_total[10m]) > 5
        for: 2m
        labels:
          severity: critical
          component: consensus
        annotations:
          summary: "Repeated consensus failures"
          description: "{{ $value }} consensus failures in the last 10 minutes"

      - alert: LeaderElectionStuck
        expr: time() - aurigraph_last_leader_election_timestamp > 300
        for: 1m
        labels:
          severity: warning
          component: consensus
        annotations:
          summary: "Leader election potentially stuck"
          description: "No leader election in the last 5 minutes"

      - alert: LowValidatorCount
        expr: sum(up{job="aurigraph-validators"}) < 3
        for: 2m
        labels:
          severity: critical
          component: consensus
        annotations:
          summary: "Insufficient validators online"
          description: "Only {{ $value }} validators are online, minimum is 3"

  - name: aurigraph-quantum-alerts
    rules:
      # Quantum Security Alerts
      - alert: QuantumSecurityLevelDrop
        expr: aurigraph_quantum_security_level < 6
        for: 1m
        labels:
          severity: critical
          component: quantum
        annotations:
          summary: "Quantum security level compromised"
          description: "Security level is {{ $value }}, below required level 6"

      - alert: QuantumKeyRotationOverdue
        expr: time() - aurigraph_last_key_rotation_timestamp > 7200  # 2 hours
        for: 5m
        labels:
          severity: warning
          component: quantum
        annotations:
          summary: "Quantum key rotation overdue"
          description: "Last key rotation was {{ $value | humanizeDuration }} ago"

      - alert: HighQuantumKeyGenerationFailures
        expr: rate(aurigraph_quantum_key_generation_failures_total[10m]) > 0.1
        for: 5m
        labels:
          severity: warning
          component: quantum
        annotations:
          summary: "High quantum key generation failure rate"
          description: "Key generation failure rate: {{ $value }} per second"

      - alert: NTRUEncryptionFailures
        expr: increase(aurigraph_ntru_encryption_failures_total[5m]) > 10
        for: 2m
        labels:
          severity: warning
          component: quantum
        annotations:
          summary: "NTRU encryption failures detected"
          description: "{{ $value }} NTRU encryption failures in 5 minutes"

  - name: aurigraph-system-alerts
    rules:
      # System Resource Alerts
      - alert: HighMemoryUsage
        expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes > 0.9
        for: 5m
        labels:
          severity: warning
          component: system
        annotations:
          summary: "High memory usage"
          description: "Memory usage is {{ $value | humanizePercentage }} on {{ $labels.instance }}"

      - alert: HighCPUUsage
        expr: 100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 90
        for: 10m
        labels:
          severity: warning
          component: system
        annotations:
          summary: "High CPU usage"
          description: "CPU usage is {{ $value }}% on {{ $labels.instance }}"

      - alert: DiskSpaceLow
        expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes) * 100 < 15
        for: 5m
        labels:
          severity: warning
          component: system
        annotations:
          summary: "Low disk space"
          description: "Disk space is {{ $value }}% full on {{ $labels.instance }}"

      - alert: DiskSpaceCritical
        expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes) * 100 < 5
        for: 2m
        labels:
          severity: critical
          component: system
        annotations:
          summary: "Critical disk space"
          description: "Disk space is {{ $value }}% full on {{ $labels.instance }}"

  - name: aurigraph-container-alerts
    rules:
      # Container Health Alerts
      - alert: ContainerDown
        expr: absent(container_last_seen{name=~"aurigraph.*"})
        for: 2m
        labels:
          severity: critical
          component: containers
        annotations:
          summary: "Container is down"
          description: "Container {{ $labels.name }} has been down for 2+ minutes"

      - alert: ContainerHighMemoryUsage
        expr: container_memory_usage_bytes{name=~"aurigraph.*"} / container_spec_memory_limit_bytes > 0.9
        for: 5m
        labels:
          severity: warning
          component: containers
        annotations:
          summary: "Container high memory usage"
          description: "Container {{ $labels.name }} memory usage: {{ $value | humanizePercentage }}"

      - alert: ContainerRestartLoop
        expr: increase(container_start_time_seconds{name=~"aurigraph.*"}[10m]) > 3
        for: 5m
        labels:
          severity: warning
          component: containers
        annotations:
          summary: "Container restart loop detected"
          description: "Container {{ $labels.name }} has restarted {{ $value }} times in 10 minutes"

  - name: aurigraph-network-alerts
    rules:
      # Network Performance Alerts
      - alert: HighNetworkPacketLoss
        expr: rate(node_network_transmit_drop_total[5m]) > 100
        for: 5m
        labels:
          severity: warning
          component: network
        annotations:
          summary: "High network packet loss"
          description: "Packet drop rate: {{ $value }} packets/sec on {{ $labels.instance }}"

      - alert: NetworkConnectivityIssues
        expr: up{job="aurigraph-nodes"} == 0
        for: 2m
        labels:
          severity: critical
          component: network
        annotations:
          summary: "Network node connectivity issues"
          description: "Node {{ $labels.instance }} is unreachable"

      - alert: P2PConnectionDrop
        expr: aurigraph_p2p_connections < 10
        for: 5m
        labels:
          severity: warning
          component: network
        annotations:
          summary: "Low P2P connections"
          description: "Only {{ $value }} P2P connections active, below minimum threshold"

  - name: aurigraph-transaction-alerts
    rules:
      # Transaction Processing Alerts
      - alert: TransactionPoolOverflow
        expr: aurigraph_transaction_pool_size > 100000
        for: 3m
        labels:
          severity: warning
          component: transactions
        annotations:
          summary: "Transaction pool overflow"
          description: "Transaction pool size: {{ $value }}, above 100K threshold"

      - alert: HighTransactionFailureRate
        expr: rate(aurigraph_transaction_failures_total[5m]) / rate(aurigraph_transactions_total[5m]) > 0.05
        for: 5m
        labels:
          severity: warning
          component: transactions
        annotations:
          summary: "High transaction failure rate"
          description: "Transaction failure rate: {{ $value | humanizePercentage }}"

      - alert: TransactionProcessingStalled
        expr: rate(aurigraph_transactions_total[2m]) == 0
        for: 3m
        labels:
          severity: critical
          component: transactions
        annotations:
          summary: "Transaction processing stalled"
          description: "No transactions processed in the last 2 minutes"

  - name: aurigraph-smart-contract-alerts
    rules:
      # Smart Contract Alerts
      - alert: SmartContractExecutionFailures
        expr: increase(aurigraph_smart_contract_failures_total[10m]) > 50
        for: 3m
        labels:
          severity: warning
          component: smart-contracts
        annotations:
          summary: "High smart contract execution failures"
          description: "{{ $value }} smart contract failures in 10 minutes"

      - alert: ContractGasLimitExceeded
        expr: increase(aurigraph_contract_gas_limit_exceeded_total[5m]) > 20
        for: 2m
        labels:
          severity: warning
          component: smart-contracts
        annotations:
          summary: "Contract gas limit exceeded frequently"
          description: "{{ $value }} gas limit exceeded events in 5 minutes"

  - name: aurigraph-ai-alerts
    rules:
      # AI Optimization Alerts
      - alert: AIOptimizerDown
        expr: absent(aurigraph_ai_optimizer_status)
        for: 5m
        labels:
          severity: warning
          component: ai
        annotations:
          summary: "AI optimizer is not responding"
          description: "AI optimizer has been unresponsive for 5+ minutes"

      - alert: PredictionAccuracyDrop
        expr: aurigraph_ai_prediction_accuracy < 0.8
        for: 10m
        labels:
          severity: warning
          component: ai
        annotations:
          summary: "AI prediction accuracy dropped"
          description: "Prediction accuracy: {{ $value | humanizePercentage }}, below 80% threshold"