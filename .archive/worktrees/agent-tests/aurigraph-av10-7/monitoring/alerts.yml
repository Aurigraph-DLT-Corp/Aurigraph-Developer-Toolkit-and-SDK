groups:
  - name: aurigraph_platform_alerts
    interval: 30s
    rules:
      # Performance Alerts
      - alert: LowTPS
        expr: aurigraph_tps < 500000
        for: 5m
        labels:
          severity: warning
          component: platform
        annotations:
          summary: "Low TPS detected"
          description: "TPS has dropped below 500k (current: {{ $value }})"

      - alert: CriticalLowTPS
        expr: aurigraph_tps < 100000
        for: 2m
        labels:
          severity: critical
          component: platform
        annotations:
          summary: "Critical TPS degradation"
          description: "TPS has dropped below 100k (current: {{ $value }})"

      - alert: HighTransactionLatency
        expr: histogram_quantile(0.95, rate(aurigraph_transaction_latency_ms_bucket[5m])) > 1000
        for: 5m
        labels:
          severity: warning
          component: platform
        annotations:
          summary: "High transaction latency"
          description: "95th percentile latency is above 1000ms"

      # Node Health Alerts
      - alert: NodeDown
        expr: aurigraph_node_status == 0
        for: 1m
        labels:
          severity: critical
          component: nodes
        annotations:
          summary: "Node is down"
          description: "Node {{ $labels.node_id }} ({{ $labels.node_type }}) is down"

      - alert: LowPeerConnections
        expr: aurigraph_peer_connections < 3
        for: 5m
        labels:
          severity: warning
          component: nodes
        annotations:
          summary: "Low peer connections"
          description: "Node {{ $labels.node_id }} has less than 3 peer connections"

      - alert: ValidatorNodeIssue
        expr: aurigraph_active_nodes{node_type="VALIDATOR"} < 3
        for: 2m
        labels:
          severity: critical
          component: consensus
        annotations:
          summary: "Insufficient validator nodes"
          description: "Less than 3 validator nodes are active"

      # Resource Alerts
      - alert: HighMemoryUsage
        expr: aurigraph_resource_usage{resource_type="memory"} > 90
        for: 5m
        labels:
          severity: warning
          component: resources
        annotations:
          summary: "High memory usage"
          description: "Node {{ $labels.node_id }} memory usage is above 90%"

      - alert: HighCPUUsage
        expr: aurigraph_resource_usage{resource_type="cpu"} > 85
        for: 5m
        labels:
          severity: warning
          component: resources
        annotations:
          summary: "High CPU usage"
          description: "Node {{ $labels.node_id }} CPU usage is above 85%"

      # Consensus Alerts
      - alert: ConsensusLatencyHigh
        expr: histogram_quantile(0.95, rate(aurigraph_consensus_round_duration_ms_bucket[5m])) > 500
        for: 5m
        labels:
          severity: warning
          component: consensus
        annotations:
          summary: "High consensus latency"
          description: "Consensus round duration 95th percentile is above 500ms"

      - alert: FrequentLeaderElections
        expr: rate(aurigraph_leader_elections_total[5m]) > 0.5
        for: 5m
        labels:
          severity: warning
          component: consensus
        annotations:
          summary: "Frequent leader elections"
          description: "More than 0.5 leader elections per second"

      # Smart Contract Alerts
      - alert: ContractExecutionSlow
        expr: histogram_quantile(0.95, rate(aurigraph_contract_execution_time_ms_bucket[5m])) > 1000
        for: 5m
        labels:
          severity: warning
          component: smart-contracts
        annotations:
          summary: "Slow contract execution"
          description: "Contract execution 95th percentile is above 1000ms"

      - alert: LowContractVerificationScore
        expr: aurigraph_contract_verification_score < 70
        for: 2m
        labels:
          severity: warning
          component: smart-contracts
        annotations:
          summary: "Low contract verification score"
          description: "Contract {{ $labels.contract_id }} verification score is below 70%"

      # Quantum Security Alerts
      - alert: QuantumSecurityLevelDegraded
        expr: aurigraph_quantum_security_level < 5
        for: 1m
        labels:
          severity: critical
          component: quantum-crypto
        annotations:
          summary: "Quantum security level degraded"
          description: "Security level has dropped below Level 5 (current: {{ $value }})"

      - alert: LowNTRUEncryptionRate
        expr: aurigraph_ntru_encryptions_per_sec < 100
        for: 5m
        labels:
          severity: warning
          component: quantum-crypto
        annotations:
          summary: "Low NTRU encryption rate"
          description: "NTRU encryption rate is below 100/sec"

      # RWA Platform Alerts
      - alert: LowComplianceScore
        expr: aurigraph_compliance_score < 80
        for: 5m
        labels:
          severity: warning
          component: rwa
        annotations:
          summary: "Low compliance score"
          description: "Compliance score for {{ $labels.jurisdiction }} is below 80%"

      # Cross-Chain Bridge Alerts
      - alert: BridgeTransactionFailures
        expr: rate(aurigraph_bridge_transactions_total{status="failed"}[5m]) > 0.1
        for: 5m
        labels:
          severity: warning
          component: cross-chain
        annotations:
          summary: "High bridge transaction failure rate"
          description: "Bridge transaction failure rate is above 10%"

      # AI Optimizer Alerts
      - alert: LowAIPredictionAccuracy
        expr: aurigraph_ai_predictions_accuracy < 70
        for: 10m
        labels:
          severity: warning
          component: ai-optimizer
        annotations:
          summary: "Low AI prediction accuracy"
          description: "AI prediction accuracy for {{ $labels.prediction_type }} is below 70%"

      # Error Rate Alerts
      - alert: HighErrorRate
        expr: rate(aurigraph_errors_total[5m]) > 10
        for: 5m
        labels:
          severity: warning
          component: platform
        annotations:
          summary: "High error rate"
          description: "Error rate is above 10/sec for component {{ $labels.component }}"

      - alert: CriticalErrorSpike
        expr: rate(aurigraph_errors_total[1m]) > 100
        for: 1m
        labels:
          severity: critical
          component: platform
        annotations:
          summary: "Critical error spike"
          description: "Error rate spike above 100/sec for component {{ $labels.component }}"